# 🎤 频谱镜子 - 快速开始指南

## ✨ 模块概述

**频谱镜子**是一个实时语音频谱分析工具，专为练习和掌握汉语拼音中的送气/不送气音（如 zhi/chi）设计。通过可视化频谱图和AI分析，帮助学习者"看见"自己的发音。

### 核心功能

✅ **实时频谱图可视化** - 将声音转化为直观的频谱图  
✅ **VOT 自动检测** - 精确测量送气时长  
✅ **AI 智能分类** - 自动识别 zhi/chi 并给出置信度  
✅ **个性化反馈** - 根据你的发音特点提供改进建议  
✅ **三种练习模式** - 自由练习、针对性训练  
✅ **历史记录** - 追踪你的进步轨迹  

---

## 🚀 快速启动（30秒）

### 1️⃣ 启动系统

```bash
cd /Users/lapulasiyao/Desktop/音高曲线比对系统
python3 web_interface.py
```

或使用现有启动脚本：

```bash
python3 start.py
```

### 2️⃣ 访问频谱镜子

打开浏览器，访问主页后点击 **"频谱镜子"** 按钮：

```
http://localhost:5000/
```

或直接访问：

```
http://localhost:5000/spectrogram_mirror
```

### 3️⃣ 开始练习

1. **选择模式** - 点击 "练习 zhi" 或 "练习 chi"
2. **录音** - 点击 "开始录音"，清晰发出目标音
3. **分析** - 点击 "停止录音"，等待分析
4. **查看** - 观察频谱图和AI反馈
5. **改进** - 根据建议调整发音，重复练习

---

## 📖 核心概念

### 频谱图解读

频谱图是声音的"指纹"，三个维度展示声音特征：

- **横轴（X）**: 时间进程
- **纵轴（Y）**: 频率高低（0-8000Hz）
- **颜色**: 能量强度（黑→红→黄→白，越亮能量越强）

### zhi vs chi 的区别

| 特征 | zhi（不送气） | chi（送气） | 频谱图表现 |
|-----|-------------|-----------|----------|
| **VOT** | < 30ms | > 60ms | 送气段长度 |
| **送气强度** | < 40分 | > 60分 | 高频能量 |
| **视觉** | "瘦条" | "胖云" | 形态差异 |

**VOT (Voice Onset Time)**: 从辅音爆发到声带振动的时间间隔，是区分送气/不送气的黄金指标。

---

## 🎯 三种练习模式

### 模式 1: 自由练习
- 无特定目标
- 只显示分析结果
- 适合探索和熟悉系统

### 模式 2: 练习 zhi（不送气）
- 系统以"不送气音"标准评分
- 提供针对性改进建议
- 目标：VOT < 30ms，送气强度 < 40

### 模式 3: 练习 chi（送气）
- 系统以"送气音"标准评分
- 提供针对性改进建议
- 目标：VOT > 60ms，送气强度 > 60

---

## 📊 评分系统

系统会给出 **0-100分** 的综合评分，包含三个维度：

1. **分类准确性**（40分）- 是否发对了音
2. **VOT 准确性**（30分）- 送气时长是否达标
3. **送气强度**（30分）- 送气力度是否合适

### 等级划分

| 等级 | 分数 | 评价 |
|-----|------|------|
| **S** | 90-100 | 完美！母语水平 |
| **A** | 80-89 | 优秀，继续保持 |
| **B** | 70-79 | 良好，稍加练习 |
| **C** | 60-69 | 及格，需要改进 |
| **D** | < 60 | 需要重点练习 |

---

## 🎓 练习技巧

### 技巧 1: 对比训练
1. 先练习 zhi，观察"瘦条"频谱
2. 再练习 chi，观察"胖云"频谱
3. 快速切换，强化肌肉记忆

### 技巧 2: 模板对照
1. 勾选 "显示目标模板"
2. 尝试让你的频谱图与半透明模板重合
3. 调整送气强度和时长

### 技巧 3: 录音技巧
- 距离麦克风 **10-20cm**
- 在 **安静环境** 录音
- 录音时长 **0.5-2秒**
- 发音要 **清晰、自然**

### 技巧 4: 渐进练习
1. **第一阶段**: 能发出两个不同的音（不管对错）
2. **第二阶段**: 能稳定发出目标音（评分 C 以上）
3. **第三阶段**: 能准确发出目标音（评分 A 以上）
4. **第四阶段**: 能随意切换（快速 zhi-chi-zhi-chi）

---

## 🔧 技术细节

### 文件结构

```
音高曲线比对系统/
├── spectrogram_analyzer.py          # 核心频谱分析模块
├── web_interface.py                 # Web 服务器（已更新）
├── templates/
│   ├── index.html                   # 主页（已更新）
│   └── spectrogram_mirror.html      # 频谱镜子页面
├── static/
│   ├── js/spectrogram-mirror.js     # 前端逻辑
│   └── css/spectrogram-mirror.css   # 样式表
└── 频谱镜子使用说明.md                # 详细文档
```

### API 端点

所有 API 都接受 POST 请求，音频格式为 WAV：

| 端点 | 功能 | 参数 |
|-----|------|------|
| `/api/spectrogram/analyze` | 完整分析 | audio, target_phoneme (可选) |
| `/api/spectrogram/classify` | 快速分类 | audio |
| `/api/spectrogram/compare` | 与模板对比 | audio, template_type |
| `/api/spectrogram/vot` | VOT检测 | audio |

### 分析参数

- **采样率**: 16000 Hz
- **FFT 窗口**: 512
- **帧移**: 128
- **频率范围**: 0-8000 Hz

### 分类算法

使用多维度加权评分：

```python
综合得分 = VOT(权重3) + 送气强度(权重2) + 高频能量(权重1)
```

分类阈值：
- **zhi**: VOT < 30ms && 送气强度 < 40
- **chi**: VOT > 60ms && 送气强度 > 60

---

## 🐛 常见问题

### Q1: 麦克风无法访问？

**原因**:
- 浏览器未授权麦克风
- 系统隐私设置阻止
- 其他应用占用麦克风

**解决**:
1. 浏览器地址栏查看麦克风权限图标
2. 点击并选择"允许"
3. 刷新页面重试
4. 检查系统设置 → 隐私 → 麦克风

### Q2: 频谱图显示为空？

**原因**:
- 录音时长太短（< 0.3秒）
- 音量太小
- 麦克风距离太远

**解决**:
- 录音至少 0.5 秒
- 提高音量
- 靠近麦克风（10-20cm）

### Q3: 识别结果总是不准确？

**原因**:
- 发音确实需要改进
- 背景噪音干扰
- 麦克风质量问题

**解决**:
- 多练习，参考 AI 建议
- 在安静环境录音
- 使用外接麦克风

### Q4: 历史记录丢失？

**原因**:
- 清除了浏览器缓存
- 使用了无痕模式
- 更换了浏览器

**说明**:
- 历史记录存储在浏览器 localStorage
- 不会上传到服务器
- 清除缓存会丢失记录

---

## 📱 移动端使用

频谱镜子完全支持移动设备：

✅ 响应式设计，自动适配屏幕  
✅ 触摸优化的按钮和控件  
✅ 支持移动设备麦克风  
✅ 简化的移动端布局  

**推荐浏览器**: Safari (iOS) / Chrome (Android)

---

## 🎨 界面说明

### 控制面板（顶部）
- 三个模式按钮：自由 / zhi / chi
- 模板显示开关

### 录音区域（中上）
- 大按钮：开始/停止录音
- 状态指示器：显示录音状态

### 频谱图区域（中间）
- Canvas 画布：实时/静态频谱图
- 坐标轴：时间（秒）+ 频率（Hz）
- 可选模板叠加：半透明目标区域

### 分析结果区域（中下）
四个卡片：
1. **识别结果** - 大字号显示预测音素和置信度
2. **发音特征** - VOT 和送气强度进度条
3. **音素对比** - zhi vs chi 置信度雷达对比
4. **改进建议** - AI 生成的具体反馈

### 历史记录区域（底部）
- 时间轴展示最近 20 条记录
- 快速查看：时间、结果、评分
- 清空按钮：重置历史

---

## 🔮 未来扩展

可以添加的功能：

1. **更多音素对** - zh/ch, j/q, z/c, d/t, b/p, g/k
2. **实时流式分析** - 边录边显示频谱
3. **详细教学模式** - 频谱特征解释动画
4. **进度统计** - 每日/每周练习图表
5. **多人对比** - 与标准发音或他人对比
6. **导出功能** - 导出频谱图和分析报告
7. **游戏化** - 成就系统、挑战任务
8. **离线模式** - PWA 支持离线使用

---

## 📚 相关文档

- **详细使用说明**: `频谱镜子使用说明.md`
- **技术方案**: `共振峰频谱图波形表示发音.md`
- **主系统文档**: 查看主页其他功能模块

---

## 💡 学习资源

### 理论基础

- **VOT**: Voice Onset Time，语音学中的黄金指标
- **送气音**: Aspirated consonants，发音时伴随强气流
- **频谱分析**: 傅里叶变换将时域信号转为频域

### 实践建议

1. **每天练习 10-15 分钟**
2. **关注趋势而非单次结果**
3. **录制自己的进步视频**
4. **与标准发音对比**
5. **请母语者给反馈**

---

## 🎉 开始你的语音之旅

频谱镜子不仅是一个工具，更是一面"魔镜"——它能让你看见声音，理解发音，掌握语言的奥秘。

**现在就开始吧！**

```bash
python3 web_interface.py
```

然后访问: **http://localhost:5000/spectrogram_mirror**

---

## 👨‍💻 技术支持

遇到问题？

1. 查看 `频谱镜子使用说明.md` 的详细文档
2. 检查浏览器控制台的错误信息
3. 确认麦克风权限和设置
4. 尝试更换浏览器或设备

---

## 📝 更新日志

### v1.0 (2025-10-15)
- ✅ 初始版本发布
- ✅ 核心频谱分析功能
- ✅ zhi/chi 自动分类
- ✅ VOT 自动检测
- ✅ 三种练习模式
- ✅ 历史记录功能
- ✅ 移动端适配

---

**祝你学习愉快，发音进步！** 🎊

---

*Created by AI Assistant | 2025-10-15*

